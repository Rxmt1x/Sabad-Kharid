<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href=" IRANYekan, sans-serif">
    <link rel="preconnect" href=" IRANYekan, sans-serif" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css">
    <title>موفق</title>
</head>
<body>
    <div class="header">
    <p>پرداخت موفقیت امیز بود</p>
    </div>

    <div class="page">
    <a class="button" href="../index.html" onclick="purchase();">صفحه اصلی</a>
    </div>

    <script src="../JS/products.js"></script>     
    <script src="../JS/cartpage.js"></script>      

    <script>
function purchase() {
  const savedCart = localStorage.getItem("cart");
  localStorage.removeItem("cart");

  if (savedCart) {
    const cart = JSON.parse(savedCart);

    cart.forEach(item => {
    const product = products.find(p => p.id === item.productId);
    if (product && product.stock?.[item.size] !== undefined) {
    product.stock[item.size] -= item.quantity;

    if (product.stock[item.size] <= 0) {
        const original = defaultProducts.find(p => p.id === item.productId);
        if (original?.stock?.[item.size] !== undefined) {
        product.stock[item.size] = original.stock[item.size];
}}}});
saveStock();
}};
    </script>
</body>
</html>